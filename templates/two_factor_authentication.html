{% extends "layout.html" %}
{% load crispy_forms_tags %}
{% load static %}
{% block content %}
{% block title %}<title>Two Factor Authentication</title>{% endblock %}

<style>
    body {
        background-color: rgb(243, 243, 243);
    }

    input {
        margin-top: 15px;
    }
</style>
<section class="two_factor_authentication align-items-center text-center py-5">
    <div class="container py-5">
        <div class="row py-2 align-items-center d-flex justify-content-center">
            <p class="display-1">Algorithm</p>
            <!-- <div class="d-flex justify-content-center"> -->
            <div class="col-lg-5 col-md-7 py-5">
                <div class="card" data-aos="zoom-in" data-aos-duration="3000">
                    <form method="POST" action="{% url 'two_factor_authentication' request.user.id %}">
                        {% csrf_token %}
                        <div class="card-body">
                            <h5 class="card-title h1">2FA</h5>
                            {% if not request.user.google_authenticator %}
                            <div class="mt-5 d-flex justify-content-center">
                                <div class="text-start">
                                    <p class="text-center fw-bold">Your Two Factor Autentication currently disabled</p>
                                    <p class="text-center fw-bold">Download google authenticator from play store in your mobile.</p>
                                    <hr>
                                    <p class="text-center fw-bold">If you are using PC</p>
                                    <p>1. Scan the qrcode using mobile</p>
                                    <p>2. Enter the six digit code generated by google
                                        authenticator below, to enable Two Factor Authentication.</p>
                                    <hr>
                                    <p class="text-center fw-bold">If you are using mobile</p>
                                    <p>1. Choose 'Enter a setup key' option. </p>
                                    <p>2. Enter you account name as your wish.</p>
                                    <p>3. Enter you secret authentication key shown below.</p>
                                    <p>4. NOTE: Choose TIME BASED authentication.</p>
                                    <p>5. After finishing above steps, enter the six digit code generated by google
                                        authenticator below, to enable Two Factor Authentication.</p>
                                    <hr>
                                </div>
                            </div>
                            <img src="/mediafiles/{{request.user.authenticator_qrcode}}" alt="" class="img-fluid">
                            {% else %}
                            <div class="mt-5 d-flex justify-content-center">
                                <div class="text-start">
                                    <p>Enter your six digit code to disable Two factor authentication.</p>
                                    <p class="text-center fw-bold"> Currently Two factor authentication enabled.</p>
                                </div>
                            </div>
                            {% endif %}
                            <div class="form py-5 text-center text-muted fw-lighter">
                                <p class="text-center fw-bold text-danger">Don't share this code with anyone.</p>
                                <input type="text" class="form-control"
                                    value="{{request.user.authenticator_secret_code}}" disabled>
                                <div class="form-text">It is your secret key</div>
                                {{form|crispy}}
                            </div>
                            <div class="d-grid col-8 mx-auto">
                                <button class="btn lead" type="submit"> submit </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <!-- </div> -->
        </div>
</section>
{% endblock %}